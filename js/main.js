!function e(i,s,l){function n(d,t){if(!s[d]){if(!i[d]){var o="function"==typeof require&&require;if(!t&&o)return o(d,!0);if(a)return a(d,!0);var r=new Error("Cannot find module '"+d+"'");throw r.code="MODULE_NOT_FOUND",r}var c=s[d]={exports:{}};i[d][0].call(c.exports,function(e){var s=i[d][1][e];return n(s?s:e)},c,c.exports,e,i,s,l)}return s[d].exports}for(var a="function"==typeof require&&require,d=0;d<l.length;d++)n(l[d]);return n}({1:[function(e,i,s){"use strict";var l=e("./weeks");$(window).ready(function(){function e(e){var i=e?moment().week(e):moment(),s=i.isoWeekday(1).format("DD"),l=i.isoWeekday(7).format("DD"),n=i.format("MM");$(".item-week").html("Week "+s+"-"+l+"."+n)}var i=void 0;$(".on-btn").click(function(){if("none"==(i=document.getElementById("box").style.display)){document.getElementById("box").style.display="block",$(".flexslider").flexslider({animation:"slide",slideshow:!1,controlNav:!1,controlsContainer:$(".custom-controls-container"),customDirectionNav:$(".custom-navigation a"),keyboard:!1,animationLoop:!0,after:function(e){e.currentSlide==e.last&&((0,l.addLastWeekSlide)($(".flexslider")),console.log("last transition ended"))}});var e=moment().isoWeekday(),s=void 0;switch(e){case 1:s=".monday";break;case 2:s=".tuesday";break;case 3:s=".wednesday";break;case 4:s=".thursday";break;case 5:s=".friday";break;case 6:s=".saturday";break;case 7:s=".sunday"}(0,l.initSlider)($(".flex-active-slide").find(s))}else"block"==i&&(document.getElementById("box").style.display="none")}),$(".close-button").click(function(){document.getElementById("box").style.display="none"}),$(".switch-on").click(l.daytimeSliderChanges),$(".switch-off").click(l.daytimeSliderChanges);var s=moment().week(),n=moment().week();e(n),n==s?($(".flex-prev").hide(),$(".flex-prev-block").show()):($(".flex-prev-block").hide(),$(".flex-prev").show()),$(".flex-next").click(function(){$(".flex-prev").show(),$(".flex-prev-block").hide(),n==s?n=s+1:n==a?n=a+1:n+=1,e(n)});var a,d=n;$(".flex-prev").click(function(){if(n==s)return!1;n-=1,d=n,d==s?($(".flex-prev").hide(),$(".flex-prev-block").show()):($(".flex-prev").show(),$(".flex-prev-block").hide()),e(n),a=n}),$(".add-button").click(function(){var e=$(".flex-active-slide").find(".monday");(0,l.addHandle)(e)});var t=null;$(".del-button").mousedown(function(){console.log("delete"),console.log($(":focus")),t=$(":focus").hasClass("ui-slider-handle")?$(":focus"):null}),$(".del-button").click(function(){t&&(0,l.deleteHandle)(t)})})},{"./weeks":2}],2:[function(e,i,s){"use strict";function l(e){if(Array.isArray(e)){for(var i=0,s=Array(e.length);i<e.length;i++)s[i]=e[i];return s}return Array.from(e)}function n(e){var i=e.getBoundingClientRect();return{top:i.top+window.scrollY,bottom:i.bottom+window.scrollY,left:i.left+window.scrollX,right:i.right+window.scrollX}}function a(e,i){return i&&(e=e.filter(function(e){return e<=14&&e>=4})),e}function d(e){var i=23-(moment().hour()+1);return i<0&&(i=0),e&&(i<4?i=4:i>14&&(i=14)),console.log("default",i),i}function t(e,i){i=i?a(i,h):[d(h)],e.slider({orientation:"vertical",min:h?4:0,max:h?14:23,values:i,step:1,animate:!0,start:function(e,i){var s=23-i.value;p.text(s),p.show(),p.css("top",n(i.handle).top-10),p.css("left",n(i.handle).left+30)},slide:function(e,i){var s=n(this);if(!(e.pageX<s.right+10&&e.pageX>s.left-10&&e.pageY<s.bottom+10&&e.pageY>s.top-10))return!1;for(var l=[],a=0;a<i.values.length;a++){if(l.indexOf(i.values[a])>-1)return!1;l.push(i.values[a])}var d=23-i.value;p.text(d),p.css("top",n(i.handle).top-10),p.css("left",n(i.handle).left+30),$(".contentSlider").html(d+" hour")},stop:function(){p.hide()}}),0==i.length?e.removeClass("active-slider"):e.addClass("active-slider"),o()}function o(){$(".ui-slider-handle").off("mousedown"),$(".ui-slider-handle").on("mousedown",function(e){function i(){$(".flex-active-slide .scale-item .default-wrap").off("mouseup")}function s(e){$(l).focus();var i=n(a);e.pageX<i.right+10&&e.pageX>i.left-10&&e.pageY<i.bottom+10&&e.pageY>i.top-10?o.css("display","none"):(o.css("display","initial"),o.css("left",e.pageX-o.width()/2),o.css("top",e.pageY-o.height()/2))}var l=this;$(l).focus(),console.log(l);var a=$(this).parent()[0],d=$(a).find(".ui-slider-handle").index(l),t=$(".flex-active-slide .scale-item .default-wrap > div").index($(a)),o=$(this).clone();o.css("position","absolute"),o.css("width","25px").css("height","9px").css("left","0").css("top",0).css("opacity",.5),o.css("pointer-events","none"),$("body").append(o),console.log("sliderIndex",t),function(){$(".flex-active-slide .scale-item .default-wrap").each(function(e,i){e!==t&&$(i).mouseup(function(e){r(e,l,a,d,t)})})}(),o.mouseup(function(){console.log("clone mouseup",e)}),$("body").mousemove(function(e){s(e)}),$("body").mouseup(function(e){$("body").off("mousemove"),$("body").off("mouseup"),o.remove(),i()})})}function r(e,i,s,l,n){console.log(e);var a=$(s).slider("values"),d=$(e.currentTarget).find("div");a.splice(l,1),$(s).slider("destroy"),t($(s),a),p.hide(),console.log("newslider",d),v(d)}function c(){return $(".flexslider .slides .item:not(.clone)")}function u(e){var i=e.data("flexslider"),s=$('<li class="item">\n                                <div class="item-week">\n                                </div>\n                                <div class="scale-wrapper">\n                                    <ul class="list-scale-wrap">\n                                        <li class="times-wrap-left">\n                                            <div class="time-min">00</div>\n                                            <div class="time-max">24</div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Mon</div>\n                                            <div class="add-times-left">\n                                                <div class="default-wrap">\n                                                    <div class="monday default-slider slide-active"></div>\n                                                </div>\n                                            </div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Tue</div>\n                                            <div class="default-wrap">\n                                                <div class="default-slider  tuesday"></div>\n                                            </div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Wed</div>\n                                            <div class="default-wrap">\n                                                <div class="default-slider wednesday"></div>\n                                            </div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Th</div>\n                                            <div></div>\n                                            <div class="default-wrap">\n                                                <div class="default-slider thursday"></div>\n                                            </div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Fr</div>\n                                            <div class="default-wrap">\n                                                <div class="default-slider  friday"></div>\n                                            </div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Sat</div>\n                                            <div class="default-wrap">\n                                                <div class="default-slider  saturday"></div>\n                                            </div>\n                                        </li>\n                                        <li class="scale-item">\n                                            <div class="day">Sun</div>\n                                            <div class="add-times-right">\n                                                <div class="default-wrap">\n                                                    <div class="default-slider  sunday"></div>\n                                                </div>\n                                            </div>\n                                        </li>\n                                        <li class="times-wrap-right">\n                                            <div class="time-min">00</div>\n                                            <div class="time-max">24</div>\n                                        </li>\n                                    </ul>\n                                </div>\n                            </li>');i.addSlide(s)}function f(){h?($(".switch-on").removeClass("active"),$(".switch-off").addClass("active"),$(".default-wrap").addClass("slide-wrap"),$(".default-slider").addClass("slider"),$(".slider").removeClass("default-slider"),$(".slider").slider({min:0,max:23}),h=!1):0==h&&($(".switch-off").removeClass("active"),$(".switch-on").addClass("active"),$(".slide-wrap").addClass("default-wrap"),$(".default-wrap").removeClass("slide-wrap"),$(".slider").addClass("default-slider"),$(".default-slider").removeClass("slider"),h=!0,$(".default-slider.active-slider").each(function(e,i){var s=$(i).slider("values");$(i).slider("destroy"),t($(i),s)}))}function v(e){var i=$(e),s=[];if(s=h?[4,5,6,7,8,9,10,11,12,13,14]:[].concat(l(new Array(24).keys())),i.hasClass("active-slider")){var n=i.slider("values"),a=n[n.length-1]-1;if(n.indexOf(a)===-1&&s.indexOf(a)!==-1)n.push(n[n.length-1]-1);else{s=s.filter(function(e){return n.indexOf(e)==-1});var d=s.randomElement();void 0!=d&&n.push(d)}i.slider("destroy"),t(i,n)}else t(i),i.addClass("active-slider");i.find(".ui-slider-handle:last").focus()}function m(e){console.log(e);var i=e.parent(),s=i.find(".ui-slider-handle").index(e),l=i.slider("values");console.log("old values",l),console.log(s),l.splice(s,1),console.log("new values",l),i.slider("destroy"),t(i,l)}Object.defineProperty(s,"__esModule",{value:!0}),s.initSlider=t,s.getItems=c,s.addLastWeekSlide=u,s.daytimeSliderChanges=f,s.addHandle=v,s.deleteHandle=m,Array.prototype.randomElement=function(){return this[Math.floor(Math.random()*this.length)]};var p;$(window).ready(function(){$("body").append('<div id="slider-popup"></div>'),p=$("#slider-popup")});var h=!0},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZSIsInQiLCJuIiwiciIsInMiLCJvIiwidSIsImEiLCJyZXF1aXJlIiwiaSIsImYiLCJFcnJvciIsImNvZGUiLCJsIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiX3dlZWtzIiwiJCIsIndpbmRvdyIsInJlYWR5Iiwic2V0V2Vla1RleHQiLCJ3ZWVrIiwibSIsIm1vbWVudCIsIm1vbmRheSIsImlzb1dlZWtkYXkiLCJmb3JtYXQiLCJzdW5kYXkiLCJ0aGlzTW9udGgiLCJodG1sIiwiZGlzcGxheSIsImNsaWNrIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiZmxleHNsaWRlciIsImFuaW1hdGlvbiIsInNsaWRlc2hvdyIsImNvbnRyb2xOYXYiLCJjb250cm9sc0NvbnRhaW5lciIsImN1c3RvbURpcmVjdGlvbk5hdiIsImtleWJvYXJkIiwiYW5pbWF0aW9uTG9vcCIsImFmdGVyIiwiY3R4IiwiY3VycmVudFNsaWRlIiwibGFzdCIsImFkZExhc3RXZWVrU2xpZGUiLCJjb25zb2xlIiwibG9nIiwiZGF5IiwiYWN0aXZlRWxlbSIsImluaXRTbGlkZXIiLCJmaW5kIiwiZGF5dGltZVNsaWRlckNoYW5nZXMiLCJ0aGlzV2VlayIsImhpZGUiLCJzaG93IiwicHJldldlZWsiLCJ0aGVXZWVrIiwiYWN0aXZlTW9uZGF5IiwiYWRkSGFuZGxlIiwiZm9jdXNFbGVtIiwibW91c2Vkb3duIiwiaGFzQ2xhc3MiLCJkZWxldGVIYW5kbGUiLCIuL3dlZWtzIiwiMiIsIl90b0NvbnN1bWFibGVBcnJheSIsImFyciIsIkFycmF5IiwiaXNBcnJheSIsImFycjIiLCJmcm9tIiwiZ2V0QWJzb2x1dGVSZWN0IiwiZWxlbSIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJzY3JvbGxZIiwiYm90dG9tIiwibGVmdCIsInNjcm9sbFgiLCJyaWdodCIsImZpbHRlclZhbHVlcyIsInZhbHVlcyIsImRheXRpbWVfb24iLCJmaWx0ZXIiLCJ2IiwiZ2V0RGVmYXVsdFZhbHVlIiwidmFsdWUiLCJob3VyIiwic2VsZWN0b3IiLCJzbGlkZXIiLCJvcmllbnRhdGlvbiIsIm1pbiIsIm1heCIsInN0ZXAiLCJhbmltYXRlIiwic3RhcnQiLCJ1aSIsInNsaWRlclBvcHVwIiwidGV4dCIsImNzcyIsImhhbmRsZSIsInNsaWRlIiwidGhpc0Nvb3JkcyIsInRoaXMiLCJwYWdlWCIsInBhZ2VZIiwiZGlmZlZhbHVlcyIsImluZGV4T2YiLCJwdXNoIiwic3RvcCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJzZXREcmFnZ2FibGVzIiwib2ZmIiwib24iLCJjbGVhcldyYXBFdmVudHMiLCJtb3ZlQXQiLCJ0YXJnZXRIYW5kbGUiLCJmb2N1cyIsInRhcmdldFNsaWRlciIsImNsb25lIiwid2lkdGgiLCJoZWlnaHQiLCJwYXJlbnQiLCJoYW5kbGVJbmRleCIsImluZGV4Iiwic2xpZGVySW5kZXgiLCJhcHBlbmQiLCJlYWNoIiwiZWwiLCJtb3VzZXVwIiwiYXBwbHlEcmFnQW5kRHJvcCIsIm1vdXNlbW92ZSIsInJlbW92ZSIsIm9sZFNsaWRlclZhbHVlcyIsIm5ld1NsaWRlciIsImN1cnJlbnRUYXJnZXQiLCJzcGxpY2UiLCJnZXRJdGVtcyIsImRhdGEiLCJ0ZW1wbGF0ZSIsImFkZFNsaWRlIiwiJHNsaWRlciIsInBvc3NpYmxlQXJyIiwiY29uY2F0Iiwia2V5cyIsInBvc3NpYmxlTmV3VmFsdWUiLCJudW0iLCJuZXdWYWx1ZSIsInJhbmRvbUVsZW1lbnQiLCJ1bmRlZmluZWQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInByb3RvdHlwZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSJdLCJtYXBwaW5ncyI6IkNBQUEsUUFBVUEsR0FBRUMsRUFBRUMsRUFBRUMsR0FBRyxRQUFTQyxHQUFFQyxFQUFFQyxHQUFHLElBQUlKLEVBQUVHLEdBQUcsQ0FBQyxJQUFJSixFQUFFSSxHQUFHLENBQUMsR0FBSUUsR0FB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LFVBQVVKLGNBQWdCLFdBQzVCLE1BQU85QyxNQUFLbUQsS0FBS0MsTUFBTUQsS0FBS0UsU0FBV3JELEtBQUs5RixTQVloRCxJQUFJd0YsRUFDSnBGLEdBQUVDLFFBQVFDLE1BQU0sV0FDWkYsRUFBRSxRQUFRa0gsT0FBTyxpQ0FDakI5QixFQUFjcEYsRUFBRSxrQkFFcEIsSUFBSXFFLElBQWEsWUE4T04iLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIF93ZWVrcyA9IHJlcXVpcmUoJy4vd2Vla3MnKTtcblxuJCh3aW5kb3cpLnJlYWR5KGZ1bmN0aW9uICgpIHtcblxuICAgIC8vICBPUEVOIFdJREdFVFxuICAgIHtcbiAgICAgICAgdmFyIGRpc3BsYXkgPSB2b2lkIDA7XG4gICAgICAgICQoJy5vbi1idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JveCcpLnN0eWxlLmRpc3BsYXk7XG4gICAgICAgICAgICBpZiAoZGlzcGxheSA9PSAnbm9uZScpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm94Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cbiAgICAgICAgICAgICAgICAkKCcuZmxleHNsaWRlcicpLmZsZXhzbGlkZXIoe1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICdzbGlkZScsXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc2hvdzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xOYXY6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sc0NvbnRhaW5lcjogJCgnLmN1c3RvbS1jb250cm9scy1jb250YWluZXInKSxcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRGlyZWN0aW9uTmF2OiAkKCcuY3VzdG9tLW5hdmlnYXRpb24gYScpLFxuICAgICAgICAgICAgICAgICAgICBrZXlib2FyZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbkxvb3A6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGFmdGVyOiBmdW5jdGlvbiBhZnRlcihjdHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHguY3VycmVudFNsaWRlID09IGN0eC5sYXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKDAsIF93ZWVrcy5hZGRMYXN0V2Vla1NsaWRlKSgkKCcuZmxleHNsaWRlcicpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGFzdCB0cmFuc2l0aW9uIGVuZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIFNldCBDdXJyZW50IGRheSBzbGlkZXIgYWN0aXZlLCB3aXRoIG9uZSB2YWx1ZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRheSA9IG1vbWVudCgpLmlzb1dlZWtkYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZUVsZW0gPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlRWxlbSA9ICcubW9uZGF5JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVFbGVtID0gJy50dWVzZGF5JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVFbGVtID0gJy53ZWRuZXNkYXknO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUVsZW0gPSAnLnRodXJzZGF5JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVFbGVtID0gJy5mcmlkYXknO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUVsZW0gPSAnLnNhdHVyZGF5JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVFbGVtID0gJy5zdW5kYXknO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICgwLCBfd2Vla3MuaW5pdFNsaWRlcikoJCgnLmZsZXgtYWN0aXZlLXNsaWRlJykuZmluZChhY3RpdmVFbGVtKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChkaXNwbGF5ID09ICdibG9jaycpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm94Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIENMT1NFUyBXSURHRVRcbiAgICAkKCcuY2xvc2UtYnV0dG9uJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm94Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9KTtcblxuICAgIC8vIERBWVRJTUUgT05MWSBPRkYgT1IgT05cblxuXG4gICAgJCgnLnN3aXRjaC1vbicpLmNsaWNrKF93ZWVrcy5kYXl0aW1lU2xpZGVyQ2hhbmdlcyk7XG4gICAgJCgnLnN3aXRjaC1vZmYnKS5jbGljayhfd2Vla3MuZGF5dGltZVNsaWRlckNoYW5nZXMpO1xuXG4gICAgLy8gV2hlbiBjbGlja2luZyBvbiB0aGUgYXJyb3dzIGdlbmVyYXRlIHdlZWsgdGV4dFxuICAgIGZ1bmN0aW9uIHNldFdlZWtUZXh0KHdlZWspIHtcbiAgICAgICAgdmFyIG0gPSB3ZWVrID8gbW9tZW50KCkud2Vlayh3ZWVrKSA6IG1vbWVudCgpO1xuICAgICAgICB2YXIgbW9uZGF5ID0gbS5pc29XZWVrZGF5KDEpLmZvcm1hdCgnREQnKTtcbiAgICAgICAgdmFyIHN1bmRheSA9IG0uaXNvV2Vla2RheSg3KS5mb3JtYXQoJ0REJyk7XG4gICAgICAgIHZhciB0aGlzTW9udGggPSBtLmZvcm1hdCgnTU0nKTtcbiAgICAgICAgJCgnLml0ZW0td2VlaycpLmh0bWwoJ1dlZWsgJyArIG1vbmRheSArICctJyArIHN1bmRheSArICcuJyArIHRoaXNNb250aCk7XG4gICAgfVxuXG4gICAgdmFyIHRoaXNXZWVrID0gbW9tZW50KCkud2VlaygpO1xuICAgIHZhciB3ZWVrID0gbW9tZW50KCkud2VlaygpO1xuICAgIHNldFdlZWtUZXh0KHdlZWspO1xuICAgIGlmICh3ZWVrID09IHRoaXNXZWVrKSB7XG4gICAgICAgICQoJy5mbGV4LXByZXYnKS5oaWRlKCk7XG4gICAgICAgICQoJy5mbGV4LXByZXYtYmxvY2snKS5zaG93KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgJCgnLmZsZXgtcHJldi1ibG9jaycpLmhpZGUoKTtcbiAgICAgICAgJCgnLmZsZXgtcHJldicpLnNob3coKTtcbiAgICB9XG5cbiAgICAkKCcuZmxleC1uZXh0JykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAkKCcuZmxleC1wcmV2Jykuc2hvdygpO1xuICAgICAgICAkKCcuZmxleC1wcmV2LWJsb2NrJykuaGlkZSgpO1xuXG4gICAgICAgIGlmICh3ZWVrID09IHRoaXNXZWVrKSB7XG4gICAgICAgICAgICB3ZWVrID0gdGhpc1dlZWsgKyAxO1xuICAgICAgICB9IGVsc2UgaWYgKHdlZWsgPT0gcHJldldlZWspIHtcbiAgICAgICAgICAgIHdlZWsgPSBwcmV2V2VlayArIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3ZWVrID0gd2VlayArIDE7XG4gICAgICAgIH1cbiAgICAgICAgc2V0V2Vla1RleHQod2Vlayk7XG4gICAgfSk7XG5cbiAgICB2YXIgdGhlV2VlayA9IHdlZWs7XG4gICAgdmFyIHByZXZXZWVrO1xuICAgICQoJy5mbGV4LXByZXYnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh3ZWVrID09IHRoaXNXZWVrKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3ZWVrID0gd2VlayAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhlV2VlayA9IHdlZWs7XG4gICAgICAgIGlmICh0aGVXZWVrID09IHRoaXNXZWVrKSB7XG4gICAgICAgICAgICAkKCcuZmxleC1wcmV2JykuaGlkZSgpO1xuICAgICAgICAgICAgJCgnLmZsZXgtcHJldi1ibG9jaycpLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJy5mbGV4LXByZXYnKS5zaG93KCk7XG4gICAgICAgICAgICAkKCcuZmxleC1wcmV2LWJsb2NrJykuaGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0V2Vla1RleHQod2Vlayk7XG5cbiAgICAgICAgcHJldldlZWsgPSB3ZWVrO1xuICAgIH0pO1xuXG4gICAgLy8gQUREIEFORCBERUwgQlVUVE9OXG5cbiAgICAkKCcuYWRkLWJ1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFjdGl2ZU1vbmRheSA9ICQoJy5mbGV4LWFjdGl2ZS1zbGlkZScpLmZpbmQoJy5tb25kYXknKTtcbiAgICAgICAgKDAsIF93ZWVrcy5hZGRIYW5kbGUpKGFjdGl2ZU1vbmRheSk7XG4gICAgfSk7XG4gICAge1xuICAgICAgICB2YXIgZm9jdXNFbGVtID0gbnVsbDtcbiAgICAgICAgJCgnLmRlbC1idXR0b24nKS5tb3VzZWRvd24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZScpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJCgnOmZvY3VzJykpO1xuICAgICAgICAgICAgJCgnOmZvY3VzJykuaGFzQ2xhc3MoJ3VpLXNsaWRlci1oYW5kbGUnKSA/IGZvY3VzRWxlbSA9ICQoJzpmb2N1cycpIDogZm9jdXNFbGVtID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJy5kZWwtYnV0dG9uJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGZvY3VzRWxlbSkge1xuICAgICAgICAgICAgICAgICgwLCBfd2Vla3MuZGVsZXRlSGFuZGxlKShmb2N1c0VsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuLy8gVE9ETyBkcmFnIGFuZCBkcm9wIGhhbmRsZXNcbi8vIFRPRE8gZmluYWwgY2FsY3VsYXRpb25zIGZ1bmN0aW9uIChkb250IGZvcmdldCBhYm91dCAyMy12YWx1ZSlcbi8vIFRPRE8gaGFuZGxlIGN1c3RvbSBzaXplPz8/XG5cbn0se1wiLi93ZWVrc1wiOjJ9XSwyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5pbml0U2xpZGVyID0gaW5pdFNsaWRlcjtcbmV4cG9ydHMuZ2V0SXRlbXMgPSBnZXRJdGVtcztcbmV4cG9ydHMuYWRkTGFzdFdlZWtTbGlkZSA9IGFkZExhc3RXZWVrU2xpZGU7XG5leHBvcnRzLmRheXRpbWVTbGlkZXJDaGFuZ2VzID0gZGF5dGltZVNsaWRlckNoYW5nZXM7XG5leHBvcnRzLmFkZEhhbmRsZSA9IGFkZEhhbmRsZTtcbmV4cG9ydHMuZGVsZXRlSGFuZGxlID0gZGVsZXRlSGFuZGxlO1xuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblxuLy8gaGVscGZ1bCBmdW5jdGlvbnNcbkFycmF5LnByb3RvdHlwZS5yYW5kb21FbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMubGVuZ3RoKV07XG59O1xuZnVuY3Rpb24gZ2V0QWJzb2x1dGVSZWN0KGVsZW0pIHtcbiAgICB2YXIgcmVjdCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiByZWN0LnRvcCArIHdpbmRvdy5zY3JvbGxZLFxuICAgICAgICBib3R0b206IHJlY3QuYm90dG9tICsgd2luZG93LnNjcm9sbFksXG4gICAgICAgIGxlZnQ6IHJlY3QubGVmdCArIHdpbmRvdy5zY3JvbGxYLFxuICAgICAgICByaWdodDogcmVjdC5yaWdodCArIHdpbmRvdy5zY3JvbGxYXG4gICAgfTtcbn1cblxudmFyIHNsaWRlclBvcHVwO1xuJCh3aW5kb3cpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAkKCdib2R5JykuYXBwZW5kKCc8ZGl2IGlkPVwic2xpZGVyLXBvcHVwXCI+PC9kaXY+Jyk7XG4gICAgc2xpZGVyUG9wdXAgPSAkKCcjc2xpZGVyLXBvcHVwJyk7XG59KTtcbnZhciBkYXl0aW1lX29uID0gdHJ1ZTtcbmZ1bmN0aW9uIGZpbHRlclZhbHVlcyh2YWx1ZXMsIGRheXRpbWVfb24pIHtcbiAgICBpZiAoZGF5dGltZV9vbikge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnZmlsdGVyaW5nLi4uJywgdmFsdWVzKTtcbiAgICAgICAgdmFsdWVzID0gdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgaWYgKHYgPD0gMTQgJiYgdiA+PSA0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIGNvbnNvbGUubG9nKHZhbHVlcyk7XG4gICAgcmV0dXJuIHZhbHVlcztcbn1cbmZ1bmN0aW9uIGdldERlZmF1bHRWYWx1ZShkYXl0aW1lX29uKSB7XG4gICAgdmFyIHZhbHVlID0gMjMgLSAobW9tZW50KCkuaG91cigpICsgMSk7XG4gICAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAwO1xuICAgIGlmIChkYXl0aW1lX29uKSB7XG4gICAgICAgIGlmICh2YWx1ZSA8IDQpIHZhbHVlID0gNDtlbHNlIGlmICh2YWx1ZSA+IDE0KSB2YWx1ZSA9IDE0O1xuICAgIH1cbiAgICBjb25zb2xlLmxvZygnZGVmYXVsdCcsIHZhbHVlKTtcbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBpbml0U2xpZGVyKHNlbGVjdG9yLCB2YWx1ZXMpIHtcbiAgICB2YWx1ZXMgPSB2YWx1ZXMgPyBmaWx0ZXJWYWx1ZXModmFsdWVzLCBkYXl0aW1lX29uKSA6IFtnZXREZWZhdWx0VmFsdWUoZGF5dGltZV9vbildO1xuICAgIHNlbGVjdG9yLnNsaWRlcih7XG4gICAgICAgIG9yaWVudGF0aW9uOiAndmVydGljYWwnLFxuICAgICAgICBtaW46IGRheXRpbWVfb24gPyA0IDogMCxcbiAgICAgICAgbWF4OiBkYXl0aW1lX29uID8gMTQgOiAyMyxcbiAgICAgICAgdmFsdWVzOiB2YWx1ZXMsXG4gICAgICAgIHN0ZXA6IDEsXG4gICAgICAgIGFuaW1hdGU6IHRydWUsXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiBzdGFydChlLCB1aSkge1xuICAgICAgICAgICAgdmFyIHYgPSAyMyAtIHVpLnZhbHVlO1xuICAgICAgICAgICAgc2xpZGVyUG9wdXAudGV4dCh2KTtcbiAgICAgICAgICAgIHNsaWRlclBvcHVwLnNob3coKTtcbiAgICAgICAgICAgIHNsaWRlclBvcHVwLmNzcygndG9wJywgZ2V0QWJzb2x1dGVSZWN0KHVpLmhhbmRsZSkudG9wIC0gMTApO1xuICAgICAgICAgICAgc2xpZGVyUG9wdXAuY3NzKCdsZWZ0JywgZ2V0QWJzb2x1dGVSZWN0KHVpLmhhbmRsZSkubGVmdCArIDMwKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2xpZGU6IGZ1bmN0aW9uIHNsaWRlKGUsIHVpKSB7XG4gICAgICAgICAgICB2YXIgdGhpc0Nvb3JkcyA9IGdldEFic29sdXRlUmVjdCh0aGlzKTtcbiAgICAgICAgICAgIC8vIG9ubHkgdHJpZ2dlcmluZyB0aGUgZXZlbnQgaWYgbW91c2UgaXMgaW4gYSByYW5nZSBvZiB0aGUgc2xpZGVyXG4gICAgICAgICAgICBpZiAoIShlLnBhZ2VYIDwgdGhpc0Nvb3Jkcy5yaWdodCArIDEwICYmIGUucGFnZVggPiB0aGlzQ29vcmRzLmxlZnQgLSAxMCAmJiBlLnBhZ2VZIDwgdGhpc0Nvb3Jkcy5ib3R0b20gKyAxMCAmJiBlLnBhZ2VZID4gdGhpc0Nvb3Jkcy50b3AgLSAxMCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGlmZlZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codWkudmFsdWVzKTtcbiAgICAgICAgICAgIC8vIHByZXZlbnQgaGFuZGxlIG92ZXJsYXBwaW5nXG4gICAgICAgICAgICBmb3IgKHZhciBhID0gMDsgYSA8IHVpLnZhbHVlcy5sZW5ndGg7IGErKykge1xuICAgICAgICAgICAgICAgIGlmIChkaWZmVmFsdWVzLmluZGV4T2YodWkudmFsdWVzW2FdKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkaWZmVmFsdWVzLnB1c2godWkudmFsdWVzW2FdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB2ID0gMjMgLSB1aS52YWx1ZTtcbiAgICAgICAgICAgIHNsaWRlclBvcHVwLnRleHQodik7XG4gICAgICAgICAgICBzbGlkZXJQb3B1cC5jc3MoJ3RvcCcsIGdldEFic29sdXRlUmVjdCh1aS5oYW5kbGUpLnRvcCAtIDEwKTtcbiAgICAgICAgICAgIHNsaWRlclBvcHVwLmNzcygnbGVmdCcsIGdldEFic29sdXRlUmVjdCh1aS5oYW5kbGUpLmxlZnQgKyAzMCk7XG4gICAgICAgICAgICAkKFwiLmNvbnRlbnRTbGlkZXJcIikuaHRtbCh2ICsgJyBob3VyJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgICAgICBzbGlkZXJQb3B1cC5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBjb25zb2xlLmxvZygnVkFMVUVTJywgdmFsdWVzKTtcbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIHNlbGVjdG9yLnJlbW92ZUNsYXNzKCdhY3RpdmUtc2xpZGVyJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZWN0b3IuYWRkQ2xhc3MoJ2FjdGl2ZS1zbGlkZXInKTtcbiAgICB9XG4gICAgc2V0RHJhZ2dhYmxlcygpO1xufVxuXG5mdW5jdGlvbiBzZXREcmFnZ2FibGVzKCkge1xuICAgICQoJy51aS1zbGlkZXItaGFuZGxlJykub2ZmKCdtb3VzZWRvd24nKTtcbiAgICAkKCcudWktc2xpZGVyLWhhbmRsZScpLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnbW91c2Vkb3duJywgdGhpcyk7XG4gICAgICAgIHZhciB0YXJnZXRIYW5kbGUgPSB0aGlzO1xuICAgICAgICAkKHRhcmdldEhhbmRsZSkuZm9jdXMoKTsgLy8gZml4IGluY29ycmVjdCBmb2N1cyBidWdcbiAgICAgICAgY29uc29sZS5sb2codGFyZ2V0SGFuZGxlKTtcbiAgICAgICAgdmFyIHRhcmdldFNsaWRlciA9ICQodGhpcykucGFyZW50KClbMF07XG4gICAgICAgIHZhciBoYW5kbGVJbmRleCA9ICQodGFyZ2V0U2xpZGVyKS5maW5kKCcudWktc2xpZGVyLWhhbmRsZScpLmluZGV4KHRhcmdldEhhbmRsZSk7XG4gICAgICAgIHZhciBzbGlkZXJJbmRleCA9ICQoJy5mbGV4LWFjdGl2ZS1zbGlkZSAuc2NhbGUtaXRlbSAuZGVmYXVsdC13cmFwID4gZGl2JykuaW5kZXgoJCh0YXJnZXRTbGlkZXIpKTtcbiAgICAgICAgdmFyIGNsb25lID0gJCh0aGlzKS5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5jc3MoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJyk7XG4gICAgICAgIGNsb25lLmNzcygnd2lkdGgnLCAnMjVweCcpLmNzcygnaGVpZ2h0JywgJzlweCcpLmNzcygnbGVmdCcsICcwJykuY3NzKCd0b3AnLCAwKS5jc3MoJ29wYWNpdHknLCAwLjUpO1xuICAgICAgICBjbG9uZS5jc3MoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTtcbiAgICAgICAgJCgnYm9keScpLmFwcGVuZChjbG9uZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzbGlkZXJJbmRleCcsIHNsaWRlckluZGV4KTtcbiAgICAgICAgZnVuY3Rpb24gaW5pdFdyYXBFdmVudHMoKSB7XG4gICAgICAgICAgICAkKCcuZmxleC1hY3RpdmUtc2xpZGUgLnNjYWxlLWl0ZW0gLmRlZmF1bHQtd3JhcCcpLmVhY2goZnVuY3Rpb24gKGksIGVsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgIT09IHNsaWRlckluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdhdHRhY2hpbmcgZXZlbnQnLCBlbCk7XG4gICAgICAgICAgICAgICAgICAgICQoZWwpLm1vdXNldXAoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5RHJhZ0FuZERyb3AoZSwgdGFyZ2V0SGFuZGxlLCB0YXJnZXRTbGlkZXIsIGhhbmRsZUluZGV4LCBzbGlkZXJJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyV3JhcEV2ZW50cygpIHtcbiAgICAgICAgICAgICQoJy5mbGV4LWFjdGl2ZS1zbGlkZSAuc2NhbGUtaXRlbSAuZGVmYXVsdC13cmFwJykub2ZmKCdtb3VzZXVwJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpbml0V3JhcEV2ZW50cygpO1xuICAgICAgICBjbG9uZS5tb3VzZXVwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjbG9uZSBtb3VzZXVwJywgZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIG1vdmVBdChlKSB7XG4gICAgICAgICAgICAkKHRhcmdldEhhbmRsZSkuZm9jdXMoKTsgLy8gZml4IGluY29ycmVjdCBmb2N1cyBidWdcbiAgICAgICAgICAgIHZhciB0aGlzQ29vcmRzID0gZ2V0QWJzb2x1dGVSZWN0KHRhcmdldFNsaWRlcik7XG4gICAgICAgICAgICBpZiAoZS5wYWdlWCA8IHRoaXNDb29yZHMucmlnaHQgKyAxMCAmJiBlLnBhZ2VYID4gdGhpc0Nvb3Jkcy5sZWZ0IC0gMTAgJiYgZS5wYWdlWSA8IHRoaXNDb29yZHMuYm90dG9tICsgMTAgJiYgZS5wYWdlWSA+IHRoaXNDb29yZHMudG9wIC0gMTApIHtcbiAgICAgICAgICAgICAgICBjbG9uZS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbG9uZS5jc3MoJ2Rpc3BsYXknLCAnaW5pdGlhbCcpO1xuICAgICAgICAgICAgICAgIGNsb25lLmNzcygnbGVmdCcsIGUucGFnZVggLSBjbG9uZS53aWR0aCgpIC8gMik7XG4gICAgICAgICAgICAgICAgY2xvbmUuY3NzKCd0b3AnLCBlLnBhZ2VZIC0gY2xvbmUuaGVpZ2h0KCkgLyAyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkKCdib2R5JykubW91c2Vtb3ZlKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbW91c2Vtb3ZlJyk7XG4gICAgICAgICAgICBtb3ZlQXQoZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJ2JvZHknKS5tb3VzZXVwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbW91c2V1cCcpO1xuICAgICAgICAgICAgJCgnYm9keScpLm9mZignbW91c2Vtb3ZlJyk7XG4gICAgICAgICAgICAkKCdib2R5Jykub2ZmKCdtb3VzZXVwJyk7XG4gICAgICAgICAgICBjbG9uZS5yZW1vdmUoKTtcbiAgICAgICAgICAgIGNsZWFyV3JhcEV2ZW50cygpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYXBwbHlEcmFnQW5kRHJvcChlLCB0YXJnZXRIYW5kbGUsIHRhcmdldFNsaWRlciwgaGFuZGxlSW5kZXgsIHNsaWRlckluZGV4KSB7XG4gICAgY29uc29sZS5sb2coZSk7XG4gICAgdmFyIG9sZFNsaWRlclZhbHVlcyA9ICQodGFyZ2V0U2xpZGVyKS5zbGlkZXIoJ3ZhbHVlcycpO1xuICAgIHZhciBuZXdTbGlkZXIgPSAkKGUuY3VycmVudFRhcmdldCkuZmluZCgnZGl2Jyk7XG4gICAgb2xkU2xpZGVyVmFsdWVzLnNwbGljZShoYW5kbGVJbmRleCwgMSk7XG4gICAgJCh0YXJnZXRTbGlkZXIpLnNsaWRlcignZGVzdHJveScpO1xuICAgIGluaXRTbGlkZXIoJCh0YXJnZXRTbGlkZXIpLCBvbGRTbGlkZXJWYWx1ZXMpO1xuICAgIHNsaWRlclBvcHVwLmhpZGUoKTtcbiAgICBjb25zb2xlLmxvZygnbmV3c2xpZGVyJywgbmV3U2xpZGVyKTtcbiAgICBhZGRIYW5kbGUobmV3U2xpZGVyKTtcbn1cblxuZnVuY3Rpb24gZ2V0SXRlbXMoKSB7XG4gICAgcmV0dXJuICQoJy5mbGV4c2xpZGVyIC5zbGlkZXMgLml0ZW06bm90KC5jbG9uZSknKTtcbn1cblxuZnVuY3Rpb24gYWRkTGFzdFdlZWtTbGlkZShzZWxlY3Rvcikge1xuICAgIHZhciBjdHggPSBzZWxlY3Rvci5kYXRhKCdmbGV4c2xpZGVyJyk7XG5cbiAgICB2YXIgdGVtcGxhdGUgPSAkKCc8bGkgY2xhc3M9XCJpdGVtXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbS13ZWVrXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzY2FsZS13cmFwcGVyXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzPVwibGlzdC1zY2FsZS13cmFwXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz1cInRpbWVzLXdyYXAtbGVmdFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpbWUtbWluXCI+MDA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0aW1lLW1heFwiPjI0PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz1cInNjYWxlLWl0ZW1cIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkYXlcIj5Nb248L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhZGQtdGltZXMtbGVmdFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZWZhdWx0LXdyYXBcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vbmRheSBkZWZhdWx0LXNsaWRlciBzbGlkZS1hY3RpdmVcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJzY2FsZS1pdGVtXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF5XCI+VHVlPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVmYXVsdC13cmFwXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlZmF1bHQtc2xpZGVyICB0dWVzZGF5XCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIGNsYXNzPVwic2NhbGUtaXRlbVwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRheVwiPldlZDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlZmF1bHQtd3JhcFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZWZhdWx0LXNsaWRlciB3ZWRuZXNkYXlcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJzY2FsZS1pdGVtXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF5XCI+VGg8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVmYXVsdC13cmFwXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlZmF1bHQtc2xpZGVyIHRodXJzZGF5XCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIGNsYXNzPVwic2NhbGUtaXRlbVwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRheVwiPkZyPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVmYXVsdC13cmFwXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlZmF1bHQtc2xpZGVyICBmcmlkYXlcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJzY2FsZS1pdGVtXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF5XCI+U2F0PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVmYXVsdC13cmFwXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlZmF1bHQtc2xpZGVyICBzYXR1cmRheVwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz1cInNjYWxlLWl0ZW1cIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkYXlcIj5TdW48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhZGQtdGltZXMtcmlnaHRcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGVmYXVsdC13cmFwXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZWZhdWx0LXNsaWRlciAgc3VuZGF5XCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIGNsYXNzPVwidGltZXMtd3JhcC1yaWdodFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpbWUtbWluXCI+MDA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0aW1lLW1heFwiPjI0PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC91bD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPicpO1xuICAgIGN0eC5hZGRTbGlkZSh0ZW1wbGF0ZSk7XG59XG5cbmZ1bmN0aW9uIGRheXRpbWVTbGlkZXJDaGFuZ2VzKCkge1xuICAgIGlmIChkYXl0aW1lX29uKSB7XG4gICAgICAgICQoJy5zd2l0Y2gtb24nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoJy5zd2l0Y2gtb2ZmJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcuZGVmYXVsdC13cmFwJykuYWRkQ2xhc3MoJ3NsaWRlLXdyYXAnKTtcbiAgICAgICAgJCgnLmRlZmF1bHQtc2xpZGVyJykuYWRkQ2xhc3MoJ3NsaWRlcicpO1xuICAgICAgICAkKCcuc2xpZGVyJykucmVtb3ZlQ2xhc3MoJ2RlZmF1bHQtc2xpZGVyJyk7XG5cbiAgICAgICAgJCgnLnNsaWRlcicpLnNsaWRlcih7XG4gICAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgICBtYXg6IDIzXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRheXRpbWVfb24gPSBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKGRheXRpbWVfb24gPT0gZmFsc2UpIHtcbiAgICAgICAgJCgnLnN3aXRjaC1vZmYnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoJy5zd2l0Y2gtb24nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoJy5zbGlkZS13cmFwJykuYWRkQ2xhc3MoJ2RlZmF1bHQtd3JhcCcpO1xuICAgICAgICAkKCcuZGVmYXVsdC13cmFwJykucmVtb3ZlQ2xhc3MoJ3NsaWRlLXdyYXAnKTtcbiAgICAgICAgJCgnLnNsaWRlcicpLmFkZENsYXNzKCdkZWZhdWx0LXNsaWRlcicpO1xuICAgICAgICAkKCcuZGVmYXVsdC1zbGlkZXInKS5yZW1vdmVDbGFzcygnc2xpZGVyJyk7XG5cbiAgICAgICAgZGF5dGltZV9vbiA9IHRydWU7XG4gICAgICAgICQoJy5kZWZhdWx0LXNsaWRlci5hY3RpdmUtc2xpZGVyJykuZWFjaChmdW5jdGlvbiAoaSwgZWwpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSAkKGVsKS5zbGlkZXIoJ3ZhbHVlcycpO1xuICAgICAgICAgICAgJChlbCkuc2xpZGVyKCdkZXN0cm95Jyk7XG4gICAgICAgICAgICBpbml0U2xpZGVyKCQoZWwpLCB2YWx1ZXMpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGFkZEhhbmRsZShzZWxlY3Rvcikge1xuICAgIHZhciAkc2xpZGVyID0gJChzZWxlY3Rvcik7XG4gICAgdmFyIHBvc3NpYmxlQXJyID0gW107XG4gICAgLy8gYSBsaXN0IG9mIHBvc3NpYmxlIGhhbmRsZSB2YWx1ZXMgd2hpY2ggY2FuIGJlIGFkZGVkXG4gICAgaWYgKGRheXRpbWVfb24pIHBvc3NpYmxlQXJyID0gWzQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNF07ZWxzZSB7XG4gICAgICAgIHBvc3NpYmxlQXJyID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShuZXcgQXJyYXkoMjQpLmtleXMoKSkpO1xuICAgIH1cbiAgICBpZiAoISRzbGlkZXIuaGFzQ2xhc3MoJ2FjdGl2ZS1zbGlkZXInKSkge1xuICAgICAgICBpbml0U2xpZGVyKCRzbGlkZXIpO1xuICAgICAgICAkc2xpZGVyLmFkZENsYXNzKCdhY3RpdmUtc2xpZGVyJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9ICRzbGlkZXIuc2xpZGVyKCd2YWx1ZXMnKTtcbiAgICAgICAgdmFyIHBvc3NpYmxlTmV3VmFsdWUgPSB2YWx1ZXNbdmFsdWVzLmxlbmd0aCAtIDFdIC0gMTtcbiAgICAgICAgaWYgKHZhbHVlcy5pbmRleE9mKHBvc3NpYmxlTmV3VmFsdWUpID09PSAtMSAmJiBwb3NzaWJsZUFyci5pbmRleE9mKHBvc3NpYmxlTmV3VmFsdWUpICE9PSAtMSkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2godmFsdWVzW3ZhbHVlcy5sZW5ndGggLSAxXSAtIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcG9zc2libGVBcnIgPSBwb3NzaWJsZUFyci5maWx0ZXIoZnVuY3Rpb24gKG51bSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZXMuaW5kZXhPZihudW0pID09IC0xO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncG9zc2libGUgcmFuZG9tIHZhbHVlcycsIHBvc3NpYmxlQXJyKTtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHBvc3NpYmxlQXJyLnJhbmRvbUVsZW1lbnQoKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyYW5kb20gbmV3IHZhbHVlJywgbmV3VmFsdWUpO1xuICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ25vIGNob2ljZXMgbGVmdCEgTm90aGluZyB0byBhZGQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2xpZGVyLnNsaWRlcignZGVzdHJveScpO1xuICAgICAgICBpbml0U2xpZGVyKCRzbGlkZXIsIHZhbHVlcyk7XG4gICAgfVxuICAgICRzbGlkZXIuZmluZCgnLnVpLXNsaWRlci1oYW5kbGU6bGFzdCcpLmZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZUhhbmRsZShoYW5kbGUpIHtcbiAgICBjb25zb2xlLmxvZyhoYW5kbGUpO1xuICAgIHZhciAkc2xpZGVyID0gaGFuZGxlLnBhcmVudCgpO1xuICAgIHZhciBoYW5kbGVJbmRleCA9ICRzbGlkZXIuZmluZCgnLnVpLXNsaWRlci1oYW5kbGUnKS5pbmRleChoYW5kbGUpO1xuICAgIHZhciB2YWx1ZXMgPSAkc2xpZGVyLnNsaWRlcigndmFsdWVzJyk7XG4gICAgY29uc29sZS5sb2coJ29sZCB2YWx1ZXMnLCB2YWx1ZXMpO1xuICAgIGNvbnNvbGUubG9nKGhhbmRsZUluZGV4KTtcbiAgICB2YWx1ZXMuc3BsaWNlKGhhbmRsZUluZGV4LCAxKTtcbiAgICBjb25zb2xlLmxvZygnbmV3IHZhbHVlcycsIHZhbHVlcyk7XG4gICAgJHNsaWRlci5zbGlkZXIoJ2Rlc3Ryb3knKTtcbiAgICBpbml0U2xpZGVyKCRzbGlkZXIsIHZhbHVlcyk7XG59XG5cbn0se31dfSx7fSxbMV0pO1xuIl19
